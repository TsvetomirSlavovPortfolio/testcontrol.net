<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>TestContro;.Net documentation</title>

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #999999;
}
.highlight .sr {
  color: #f6aa11;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #f6aa11;
}
.highlight .cm {
  color: #75715e;
}
.highlight .cp {
  color: #75715e;
}
.highlight .c1 {
  color: #75715e;
}
.highlight .cs {
  color: #75715e;
}
.highlight .c, .highlight .cd {
  color: #75715e;
}
.highlight .err {
  color: #960050;
}
.highlight .gr {
  color: #960050;
}
.highlight .gt {
  color: #960050;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #66d9ef;
}
.highlight .kd {
  color: #66d9ef;
}
.highlight .kr {
  color: #66d9ef;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .kt {
  color: #66d9ef;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #e6db74;
}
.highlight .s2 {
  color: #e6db74;
}
.highlight .sb {
  color: #e6db74;
}
.highlight .sh {
  color: #e6db74;
}
.highlight .si {
  color: #e6db74;
}
.highlight .sx {
  color: #e6db74;
}
.highlight .s1 {
  color: #e6db74;
}
.highlight .s {
  color: #e6db74;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
}
.highlight .nd {
  color: #a6e22e;
}
.highlight .ne {
  color: #a6e22e;
}
.highlight .nf {
  color: #a6e22e;
}
.highlight .vc {
  color: #ffffff;
}
.highlight .nn {
  color: #ffffff;
}
.highlight .nl {
  color: #ffffff;
}
.highlight .ni {
  color: #ffffff;
}
.highlight .bp {
  color: #ffffff;
}
.highlight .vg {
  color: #ffffff;
}
.highlight .vi {
  color: #ffffff;
}
.highlight .nv {
  color: #ffffff;
}
.highlight .w {
  color: #ffffff;
}
.highlight {
  color: #ffffff;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #ffffff;
}
.highlight .ow {
  color: #f92672;
}
.highlight .nt {
  color: #f92672;
}
.highlight .k, .highlight .kv {
  color: #f92672;
}
.highlight .kn {
  color: #f92672;
}
.highlight .kp {
  color: #f92672;
}
.highlight .o {
  color: #f92672;
}
    </style>
    <link href="stylesheets/screen.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" media="print" />
      <script src="javascripts/all.js"></script>
  </head>

  <body class="index" data-languages="[]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" alt="Navbar" />
      </span>
    </a>
    <div class="tocify-wrapper">
      <img src="images/logo1.png" alt="Logo1" />
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <div id="toc">
      </div>
        <ul class="toc-footer">
            
            <li><a href='https://github.com/qamatic/testcontrol.net'>Source @ github</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id="introduction">Introduction</h1>

<p>TestControl is a light weight test automation framework for Windows Native, WinForm and WPF applications.</p>

<h3 id="features">Features</h3>

<ul>
<li>A light weight framework - just few assembly DLLs required to get started</li>
<li>Spy Tool which helps to recognize the objects on the screen</li>
<li>Provides solid mechanism for identifying screen elements consistently in more reliable and in a resolution agnostic way</li>
<li>Screen element locators are prone to developer changes(no more xpath!)</li>
<li>In-Built smart wait logic for handling real time use cases</li>
<li>Supports Windows Native, WinForm and WPF applications</li>
<li>Supports Embedded Chrome Browser (CEFSharp) thru Selenium Extension</li>
<li>Write your automation with your own choice of test runners like MSTest, NUnit, Cucumber SpecFlow or using Fitnesse</li>
<li>It is customizable with by writing your own plugin extenders for example like generate your own test scripts in any language or detail inspection of a UI element on the screen in a customized way</li>
</ul>

<h2 id="installation">Installation</h2>

<p>Download binaries and unzip to your favourite location or relative to your Visual Studio project</p>

<ul>
<li><a href="https://github.com/qamatic/testcontrol.net/raw/master/doc/www/files/TestControl-Rel-v3.zip">Download Release-binaries(x86/x64)-v3.zip</a> </li>
</ul>

<p>Note: Nuget distribution is not yet available at this time but eventually. </p>

<h2 id="why-testcontrol">Why TestControl?</h2>

<p>Well, the framework is being developed out of many hurdles and shortcomings with many other frameworks and tools available both open source and commerically. Most of the time, locating the control on the screen is the key for any successful automation but it has been a challenge.  So TestControl is trying to solve two main issues here: provide a precise way to locate a control on the screen and secondly be resilent to beat the failure!  Lastly, CEF browser automation which you will see in another section as how to automate using TestControl.</p>

<h1 id="getting-started">Getting started</h1>

<p>TestConntrol is a library is meant for people who have some .net developement skills because it does not offer record and replay mechanism. However it is not difficult for someone to work with very basic coding skills on C# or VB.  This framework written up around MS UIAutomation so highly recommended if any third party controls implement UIAutomation patterns in order to fully take control on accessing elements.   There are cases where paint events are drawing things on the screen and its simple imposible to capture those or to automate so that something you need to be aware of and will be discussed in advanced sections as how to overcome those.</p>

<h2 id="write-a-simple-test">Write a simple test</h2>
<pre class="highlight cs tab-csharp"><code>
    <span class="n">ApplicationUnderTest</span> <span class="n">calcApp</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">ApplicationUnderTest</span><span class="p">(</span><span class="s">@"C:\Windows\System32\", "</span><span class="n">calc</span><span class="p">.</span><span class="n">exe</span><span class="s">");
</span>
    <span class="c1">//build your locators</span>
    <span class="kt">var</span> <span class="n">repo</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">ControlLocatorDefRepo</span><span class="p">(</span><span class="s">"calcapp"</span><span class="p">);</span>
    <span class="n">repo</span><span class="p">.</span><span class="nf">Wait</span><span class="p">(</span><span class="m">500</span><span class="p">);</span>  <span class="c1">// </span>
    <span class="n">repo</span><span class="p">.</span><span class="nf">FindByName</span><span class="p">(</span><span class="s">"Calculator"</span><span class="p">,</span> <span class="k">true</span><span class="p">);</span> <span class="c1">// find calculator by its name</span>

    <span class="c1">//now use locators to find</span>
     <span class="kt">var</span> <span class="n">w</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Window</span><span class="p">();</span>
     <span class="n">w</span><span class="p">.</span><span class="nf">SystemUnderTestFromRepo</span><span class="p">(</span><span class="s">"calcapp"</span><span class="p">);</span>
     <span class="n">Assert</span><span class="p">.</span><span class="nf">AreEqual</span><span class="p">(</span><span class="s">"Calculator"</span><span class="p">,</span> <span class="n">w</span><span class="p">.</span><span class="n">Caption</span><span class="p">);</span>   
</code></pre>
<p>So the above example is using repository concept if you would like to keep key map to store your locators for later use</p>

<h1 id="locators">Locators</h1>

<h2 id="control-locator">Control Locator</h2>

<p>Control locators are used to find the right element on the target window in order to automate further.  Control locators are defined in a sequence of actions using following locator types.  Window elements are hierarchical by nature for example window being the root element and drop down being a child element like that.   So one can use multiple locator types to navigate to target element of interest.  </p>
<pre class="highlight cs tab-csharp"><code>       <span class="c1">//define as how to locate an element </span>
       <span class="kt">var</span> <span class="n">controldef</span> <span class="p">=</span> <span class="k">new</span> <span class="n">ControlLocatorDef</span><span class="p">&lt;</span><span class="n">FindControl</span><span class="p">&gt;(</span>
                                                    <span class="p">()</span> <span class="p">=&gt;</span> <span class="k">new</span> <span class="nf">FindWindow</span><span class="p">(</span><span class="s">"Demo Form"</span><span class="p">),</span>   <span class="c1">// locate the window first</span>
                                                    <span class="p">()</span> <span class="p">=&gt;</span> <span class="k">new</span> <span class="nf">FindByAutomationId</span><span class="p">(</span><span class="s">"radioButton1"</span><span class="p">)</span> <span class="c1">// and then locate the radio button using automation id</span>
                                                   <span class="p">);</span>

      <span class="c1">//now choose or define your target element to be in order to access its values or trigger events on them </span>
      <span class="kt">var</span> <span class="n">radio</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">RadioButtonControl</span><span class="p">();</span>  <span class="c1">// target element type</span>
      <span class="n">radio</span><span class="p">.</span><span class="nf">SystemUnderTest</span><span class="p">(</span> <span class="n">controldef</span> <span class="p">);</span> <span class="c1">// set the locator def here</span>
      <span class="n">radio</span><span class="p">.</span><span class="n">Selected</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span> <span class="c1">// now check radio button</span>


</code></pre>
<h2 id="find-by-automation-id">Find By Automation Id</h2>

<p>Automation id is generally an unique id given for the elements.  </p>
<pre class="highlight cs tab-csharp"><code>
    <span class="n">IFindControl</span> <span class="n">findcontrol</span> <span class="p">=</span> <span class="nf">FindByAutomationId</span><span class="p">(</span><span class="s">"&lt;automation id to locate a target element &gt;"</span><span class="p">);</span>

</code></pre>
<h2 id="find-by-caption">Find By Caption</h2>
<pre class="highlight cs tab-csharp"><code>
    <span class="n">IFindControl</span> <span class="n">findcontrol</span> <span class="p">=</span> <span class="nf">FindByCaption</span><span class="p">(</span><span class="s">"&lt;caption/text to be used to locate a target element&gt;"</span><span class="p">);</span>

</code></pre>
<h2 id="find-by-name">Find By Name</h2>
<pre class="highlight cs tab-csharp"><code>
    <span class="n">IFindControl</span> <span class="n">findcontrol</span> <span class="p">=</span> <span class="nf">FindByName</span><span class="p">(</span><span class="s">"&lt;developers given name or OS based predefined names to be used to locate a target element&gt;"</span><span class="p">);</span>

</code></pre>
<h2 id="find-child-by-caption">Find Child By Caption</h2>
<pre class="highlight cs tab-csharp"><code>
    <span class="n">IFindControl</span> <span class="n">findcontrol</span> <span class="p">=</span> <span class="nf">FindChildByCaption</span><span class="p">(</span><span class="s">"&lt;caption/text to be used to locate a target element from an root elementt&gt;"</span><span class="p">);</span>

</code></pre>
<h2 id="find-desktop-window">Find Desktop Window</h2>
<pre class="highlight cs tab-csharp"><code>
    <span class="n">IFindControl</span> <span class="n">findcontrol</span> <span class="p">=</span> <span class="nf">FindDesktopWindow</span><span class="p">();</span>  <span class="c1">//returns your desktop window as your target element</span>

</code></pre>
<h2 id="find-window">Find Window</h2>
<pre class="highlight cs tab-csharp"><code>
    <span class="n">IFindControl</span> <span class="n">findcontrol</span> <span class="p">=</span> <span class="nf">FindWindow</span><span class="p">(&lt;</span><span class="n">Caption</span><span class="p">&gt;,</span> <span class="p">&lt;</span><span class="k">class</span><span class="nc">Name</span> <span class="n">optional</span><span class="p">&gt;);</span>  <span class="c1">//locating a target window element by its caption or class name or combination of both.</span>

</code></pre>
<h2 id="find-window-by-mouse-position">Find Window By Mouse Position</h2>
<pre class="highlight cs tab-csharp"><code>
    <span class="n">IFindControl</span> <span class="n">findcontrol</span> <span class="p">=</span> <span class="nf">FindWindowByMousePosition</span><span class="p">();</span>  <span class="c1">//locating a target window element by current mouse position.</span>

</code></pre>
<h2 id="from-handle">From Handle</h2>
<pre class="highlight cs tab-csharp"><code>
    <span class="nf">FromHandle</span><span class="p">(</span><span class="n">IntPtr</span> <span class="n">handle</span><span class="p">);</span>  <span class="c1">//locating a target window element by HWND / window handle.</span>

</code></pre>
<h2 id="mouse-click">Mouse Click</h2>
<pre class="highlight cs tab-csharp"><code>
    <span class="nf">MouseClick</span><span class="p">(</span><span class="n">Point</span> <span class="n">pt</span><span class="p">);</span>  <span class="c1">//send mouse click on the given point position</span>

</code></pre>
<h2 id="move-mouse">Move Mouse</h2>
<pre class="highlight cs tab-csharp"><code>
    <span class="nf">MouseClick</span><span class="p">(</span><span class="kt">int</span> <span class="n">moveToX</span><span class="p">,</span> <span class="kt">int</span> <span class="n">moveToY</span><span class="p">);</span>  <span class="c1">//move mouse cursor position to desired x and y coordinates</span>

</code></pre>
<h2 id="right-click-mouse">Right Click Mouse</h2>
<pre class="highlight cs tab-csharp"><code>
    <span class="nf">RightClickMouse</span><span class="p">();</span>  <span class="c1">//send right click on the current mouse cursor position</span>

</code></pre>
<h2 id="send-key-strokes">Send Key Strokes</h2>
<pre class="highlight cs tab-csharp"><code>
    <span class="nf">SendKeyStrokes</span><span class="p">(</span><span class="n">keys</span><span class="p">);</span>  <span class="c1">//send key stroke, check microsoft documentation on SendKeys</span>

</code></pre>
<h2 id="wait">Wait</h2>
<pre class="highlight cs tab-csharp"><code>
    <span class="nf">Wait</span><span class="p">(</span><span class="kt">int</span> <span class="n">milliSec</span><span class="p">);</span>  <span class="c1">//waits for given time in milli sec </span>

    <span class="c1">//for example</span>

   <span class="kt">var</span> <span class="n">controldef</span> <span class="p">=</span> <span class="k">new</span> <span class="n">ControlLocatorDef</span><span class="p">&lt;</span><span class="n">FindControl</span><span class="p">&gt;(</span>
                                                <span class="p">()</span> <span class="p">=&gt;</span> <span class="k">new</span> <span class="nf">FindWindow</span><span class="p">(</span><span class="s">"Demo Form"</span><span class="p">),</span>   <span class="c1">// locate the window first</span>
                                                <span class="p">()</span> <span class="p">=&gt;</span> <span class="k">new</span> <span class="nf">Wait</span><span class="p">(</span><span class="m">1000</span><span class="p">),</span>  <span class="c1">//wait for 1 sec before proceed next step</span>
                                                <span class="p">()</span> <span class="p">=&gt;</span> <span class="k">new</span> <span class="nf">FindByAutomationId</span><span class="p">(</span><span class="s">"radioButton1"</span><span class="p">)</span> <span class="c1">// and then locate the radio button using automation id</span>
                                               <span class="p">);</span>


</code></pre>
<h2 id="click-non-window-control-by-caption">Click Non-Window Control By Caption</h2>
<pre class="highlight cs tab-csharp"><code>

    <span class="nf">ClickNonWindowControlByCaption</span><span class="p">(</span><span class="n">String</span><span class="p">[]</span> <span class="n">captionPath</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">dblClick</span> <span class="p">=</span> <span class="k">false</span><span class="p">,</span> <span class="kt">int</span> <span class="n">offsetX</span> <span class="p">=</span> <span class="m">2</span><span class="p">,</span> <span class="kt">int</span> <span class="n">offsetY</span> <span class="p">=</span> <span class="m">2</span><span class="p">);</span>  

    <span class="c1">//for example to work with context menu</span>
            <span class="kt">var</span> <span class="n">cdef</span> <span class="p">=</span> <span class="k">new</span> <span class="n">ControlLocatorDef</span><span class="p">&lt;</span><span class="n">IFindControl</span><span class="p">&gt;(()</span> <span class="p">=&gt;</span> <span class="k">new</span> <span class="nf">FindbyCaption</span><span class="p">(</span><span class="s">"Demo application"</span><span class="p">),</span>
                                                <span class="p">()</span> <span class="p">=&gt;</span> <span class="k">new</span> <span class="nf">RightClickMouse</span><span class="p">(),</span>
                                                <span class="p">()</span> <span class="p">=&gt;</span> <span class="k">new</span> <span class="nf">Wait</span><span class="p">(</span><span class="m">100</span><span class="p">),</span>
                                                <span class="p">()</span> <span class="p">=&gt;</span> <span class="k">new</span> <span class="nf">SendKeyStrokes</span><span class="p">(</span><span class="s">"{DOWN}"</span><span class="p">,</span> <span class="k">true</span><span class="p">),</span>
                                                <span class="p">()</span> <span class="p">=&gt;</span> <span class="k">new</span> <span class="nf">Wait</span><span class="p">(</span><span class="m">100</span><span class="p">),</span>
                                                <span class="p">()</span> <span class="p">=&gt;</span> <span class="k">new</span> <span class="nf">FindWindowByMousePosition</span><span class="p">(),</span>
                                                <span class="p">()</span> <span class="p">=&gt;</span> <span class="k">new</span> <span class="nf">Wait</span><span class="p">(</span><span class="m">100</span><span class="p">),</span>
                                                <span class="p">()</span> <span class="p">=&gt;</span> <span class="k">new</span> <span class="nf">ClickNonWindowControlByCaption</span><span class="p">({</span><span class="s">"New"</span><span class="p">,</span> <span class="s">"Create folder"</span><span class="p">})</span>  <span class="c1">//under 'new' sub menu then click 'create folder' menu item</span>
                <span class="p">);</span>
            <span class="k">return</span> <span class="n">cdef</span><span class="p">;</span>    


</code></pre>
<h1 id="standard-controls">Standard Controls</h1>

<h1 id="cef-browser-control">CEF Browser Control</h1>

<p>CEF is a real chrome browser embedded into a window control.  CEF control is becoming popular as organisations are moving towards web offerings and discontiue developements on desktops. As a result, desktop applications are embedded with web applications inside that makes automation complex because you need to have a seamless flow of automation between window controls on the applicatons and CEF control as a browser in order to manipulate its elements.  Rather reinvinting the wheel, TestControl uses Selenium drivers to work with but with modified version of chromedriver that can work along with TestControl.  So the modified version chromedriver.exe is named as TCChromeDriver.exe for our use.  </p>
<pre class="highlight cs tab-csharp"><code>
    <span class="c1">// set your application under test</span>
    <span class="n">IApplicationUnderTest</span> <span class="n">app</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">ApplicationUnderTest</span><span class="p">(</span><span class="s">@"..\TestApps\", "</span><span class="n">ceftest</span><span class="p">.</span><span class="n">exe</span><span class="s">"); //ceftest.exe is a winform cotinaing cef control
</span>
    <span class="c1">//application main form has only a cef control browser control </span>
    <span class="c1">//and your mainform window caption is set to "Google"</span>

    <span class="n">app</span><span class="p">.</span><span class="nf">RunOnce</span><span class="p">();</span> <span class="c1">//now launch the application</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">app</span><span class="p">.</span><span class="nf">WaitForCaptionIfExists</span><span class="p">(</span><span class="s">"Google"</span><span class="p">,</span> <span class="m">20</span><span class="p">))</span>  <span class="c1">// wait for window appears with 20 retries</span>
    <span class="p">{</span>
        <span class="n">Assert</span><span class="p">.</span><span class="nf">IsTrue</span><span class="p">(</span><span class="k">true</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="n">Assert</span><span class="p">.</span><span class="nf">Fail</span><span class="p">(</span><span class="s">"unable to get window caption"</span><span class="p">);</span>


      <span class="c1">//locate the control as like any other .NET Control</span>
    <span class="n">WebBrowserControl</span> <span class="n">aBrowser</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">WebBrowserControl</span><span class="p">(</span><span class="s">"chrome"</span><span class="p">);</span> <span class="c1">//browser type to chrome</span>
    <span class="n">aBrowser</span><span class="p">.</span><span class="nf">SystemUnderTest</span><span class="p">(</span><span class="k">new</span> <span class="n">ControlLocatorDef</span><span class="p">&lt;</span><span class="n">FindControl</span><span class="p">&gt;(</span>
                                        <span class="p">()</span> <span class="p">=&gt;</span> <span class="k">new</span> <span class="nf">FindByAutomationId</span><span class="p">(</span><span class="s">"Form1"</span><span class="p">,</span> <span class="k">true</span><span class="p">),</span> <span class="c1">//your main form id</span>
                                        <span class="p">()</span> <span class="p">=&gt;</span> <span class="k">new</span> <span class="nf">FindByName</span><span class="p">(</span><span class="s">"Chrome Legacy Window"</span><span class="p">)</span> <span class="c1">//the spy shows the name as Chrome Legacy Window</span>
            <span class="p">));</span>
    <span class="n">Assert</span><span class="p">.</span><span class="nf">IsTrue</span><span class="p">(</span><span class="n">aBrowser</span><span class="p">.</span><span class="n">IsVisible</span><span class="p">);</span>  <span class="c1">//make sure your cef control is visible</span>


    <span class="c1">//** make sure, for this test formshow event of main form is set to load google.com into the cef browser             </span>

    <span class="c1">//now Testcontrol loads Selenium driver and switching to Selenium world</span>

    <span class="c1">// goto an Url</span>
    <span class="kt">var</span> <span class="n">url</span> <span class="p">=</span> <span class="n">aBrowser</span><span class="p">.</span><span class="n">InternalDriver</span><span class="p">.</span><span class="nf">GotoUrl</span><span class="p">(</span><span class="s">"http://msn.com"</span><span class="p">);</span>
    <span class="n">Assert</span><span class="p">.</span><span class="nf">AreEqual</span><span class="p">(</span><span class="s">"http://msn.com"</span><span class="p">,</span> <span class="n">url</span><span class="p">);</span>
    <span class="n">url</span> <span class="p">=</span> <span class="n">aBrowser</span><span class="p">.</span><span class="n">InternalDriver</span><span class="p">.</span><span class="nf">GotoUrl</span><span class="p">(</span><span class="s">"http://yahoo.com"</span><span class="p">);</span>
    <span class="n">Assert</span><span class="p">.</span><span class="nf">AreEqual</span><span class="p">(</span><span class="s">"http://yahoo.com"</span><span class="p">,</span> <span class="n">url</span><span class="p">);</span>


    <span class="c1">//to find an element</span>
    <span class="n">aBrowser</span><span class="p">.</span><span class="n">InternalDriver</span><span class="p">.</span><span class="nf">GotoUrl</span><span class="p">(</span><span class="s">"http://google.com"</span><span class="p">);</span>
    <span class="kt">var</span> <span class="n">element</span> <span class="p">=</span> <span class="n">aBrowser</span><span class="p">.</span><span class="n">InternalDriver</span><span class="p">.</span><span class="nf">FindChild</span><span class="p">(</span><span class="s">"name:q"</span><span class="p">);</span> <span class="c1">// equivalent to ByName()</span>
    <span class="n">Assert</span><span class="p">.</span><span class="nf">IsNotNull</span><span class="p">(</span><span class="n">element</span><span class="p">);</span>
    <span class="n">element</span><span class="p">.</span><span class="n">Text</span> <span class="p">=</span> <span class="s">"TDD"</span><span class="p">+</span> <span class="n">Enter</span><span class="p">;</span>
    <span class="n">element</span> <span class="p">=</span> <span class="n">aBrowser</span><span class="p">.</span><span class="n">InternalDriver</span><span class="p">.</span><span class="nf">FindChild</span><span class="p">(</span><span class="s">"name:q"</span><span class="p">);</span>
    <span class="n">Assert</span><span class="p">.</span><span class="nf">AreEqual</span><span class="p">(</span><span class="s">"lst-ib"</span><span class="p">,</span> <span class="n">element</span><span class="p">.</span><span class="nf">AsString</span><span class="p">(</span><span class="s">"Attribute:id"</span><span class="p">));</span>


    <span class="c1">//here is an example if you want use direct selenium way</span>
    <span class="n">aBrowser</span><span class="p">.</span><span class="nf">GetWebDriver</span><span class="p">().</span><span class="n">Url</span> <span class="p">=</span> <span class="s">"http://www.littlewebhut.com/articles/html_iframe_example/"</span><span class="p">;</span>

    <span class="kt">var</span> <span class="n">frame</span> <span class="p">=</span> <span class="n">aBrowser</span><span class="p">.</span><span class="nf">GetWebDriver</span><span class="p">().</span><span class="nf">FindElement</span><span class="p">(</span><span class="n">By</span><span class="p">.</span><span class="nf">Id</span><span class="p">(</span><span class="s">"imgbox"</span><span class="p">));</span>

    <span class="n">Assert</span><span class="p">.</span><span class="nf">AreEqual</span><span class="p">(</span><span class="s">"http://www.littlewebhut.com/images/eightball.gif"</span><span class="p">,</span> <span class="n">frame</span><span class="p">.</span><span class="nf">GetAttribute</span><span class="p">(</span><span class="s">"src"</span><span class="p">));</span>

    <span class="c1">//switch frame</span>
    <span class="n">aBrowser</span><span class="p">.</span><span class="nf">GetWebDriver</span><span class="p">().</span><span class="nf">SwitchTo</span><span class="p">().</span><span class="nf">Frame</span><span class="p">(</span><span class="n">frame</span><span class="p">);</span>

    <span class="kt">var</span> <span class="n">img</span> <span class="p">=</span> <span class="n">aBrowser</span><span class="p">.</span><span class="nf">GetWebDriver</span><span class="p">().</span><span class="nf">FindElement</span><span class="p">(</span><span class="n">By</span><span class="p">.</span><span class="nf">TagName</span><span class="p">(</span><span class="s">"img"</span><span class="p">));</span>
    <span class="n">Assert</span><span class="p">.</span><span class="nf">AreEqual</span><span class="p">(</span><span class="s">"http://www.littlewebhut.com/images/eightball.gif"</span><span class="p">,</span> <span class="n">img</span><span class="p">.</span><span class="nf">GetAttribute</span><span class="p">(</span><span class="s">"src"</span><span class="p">));</span>                


</code></pre>
      </div>
      <div class="dark-box">
      </div>
    </div>
  </body>
</html>
